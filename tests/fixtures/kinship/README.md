# Kinship Test Fixtures

## mouse_hs1940.cXX.txt

Reference kinship matrix for validation testing.

**Source dataset:** legacy/example/mouse_hs1940 (1940 samples, 12226 SNPs)
**Generated by:** JAMMA -gk 1 (centered relatedness matrix)
**Generated date:** 2026-01-31

## Why JAMMA Reference (Not GEMMA)

GEMMA filters samples/SNPs based on phenotype availability and MAF before computing
kinship (1410/1940 samples, 10768/12226 SNPs in mouse_hs1940). JAMMA Phase 2 computes
kinship on all samples/SNPs without filtering.

True GEMMA numerical equivalence will be validated in **Phase 3** when phenotype
handling is implemented. Phase 2 validates:

- Deterministic computation (same input â†’ same output)
- Correct kinship properties (symmetric, positive diagonal)
- GEMMA-compatible output format

## GEMMA Reference (For Phase 3)

A GEMMA reference is available at `gemma_ref.cXX.txt` for future validation.
This was generated with:

```bash
docker run --rm -v "$(pwd)":/data quay.io/biocontainers/gemma:0.98.5--ha36d3ea_0 \
  gemma -bfile /data/legacy/example/mouse_hs1940 -gk 1 -o gemma_ref -outdir /data/tests/fixtures/kinship
```

## Regeneration

To regenerate JAMMA reference:

```bash
uv run jamma -outdir tests/fixtures/kinship -o mouse_hs1940 gk -bfile legacy/example/mouse_hs1940
```
